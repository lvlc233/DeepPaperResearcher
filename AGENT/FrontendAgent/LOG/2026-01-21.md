# 2026-01-21 前端开发日志

## 19:57 - 后端对接与类型同步

### 目标
恢复前端开发上下文，与已完成的后端代码进行对接，解决字段命名不一致导致的联调问题。

### 变更范围
1.  **组件重构**:
    *   `src/components/reader/ReaderSidebar.tsx`: 将所有 `activeLayerId` 替换为 `activeViewId`，将 `layer.id` 替换为 `layer.view_id`，以匹配后端 `ViewResponse` 模型。
    *   `src/components/reader/ReaderPage.tsx`: 确认 `activeViewId` 的传递和使用与后端数据结构一致。
    *   `src/components/reader/PDFPageOverlay.tsx`: 确认标注 ID 使用 `annotation_id`。

2.  **服务层对齐**:
    *   `src/services/reader.service.ts`: 确认 API 方法参数命名与后端路由参数一致 (`viewId`, `annotationId`)。
    *   `src/types/api.d.ts` & `src/types/reader.ts`: 确认类型定义 (`ViewResponse`, `Annotation`, `Layer`) 包含后端特定的 ID 字段 (`view_id`, `annotation_id`)。

### 验证方式与结果
*   **静态检查**: 通过代码搜索 (`grep`) 确认项目中不再包含未处理的 `activeLayerId` 或 `layer.id`（排除文档和后端代码）。
*   **类型一致性**: 手动核对前端 Interface 定义与后端 Pydantic 模型（通过 `api.d.ts` 反映）的一致性。
*   **结果**: 前端阅读器模块的核心组件已完全适配后端 API 规范，消除了因字段名不匹配导致的潜在运行时错误。

### 后续计划
*   启动前端服务进行实际 API 调用测试。
*   验证 PDF 标注的增删改查功能是否与后端数据库同步正常。
